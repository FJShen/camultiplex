<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>camultiplex: camera::Drain_base Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecamera.html">camera</a></li><li class="navelem"><a class="el" href="classcamera_1_1Drain__base.html">Drain_base</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classcamera_1_1Drain__base-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">camera::Drain_base Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Interfaces with the file system. Converts sensor_msgs::Image into .jpg and .png format and stores them as images.  
 <a href="classcamera_1_1Drain__base.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for camera::Drain_base:</div>
<div class="dyncontent">
<div class="center"><img src="classcamera_1_1Drain__base__inherit__graph.png" border="0" usemap="#camera_1_1Drain__base_inherit__map" alt="Inheritance graph"/></div>
<map name="camera_1_1Drain__base_inherit__map" id="camera_1_1Drain__base_inherit__map">
<area shape="rect" id="node2" href="classcamera_1_1Drain__independent.html" title="The non&#45;nodelet version of Drain. " alt="" coords="5,80,187,107"/>
<area shape="rect" id="node3" href="classcamera_1_1Drain__nodelet.html" title="The nodelet version of of Drain. " alt="" coords="211,80,365,107"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa0ade441f6b17040ee8d25b8aa785f4c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#aa0ade441f6b17040ee8d25b8aa785f4c">Drain_base</a> ()</td></tr>
<tr class="memdesc:aa0ade441f6b17040ee8d25b8aa785f4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes depth_sub and rgb_sub as nullptr.  <a href="#aa0ade441f6b17040ee8d25b8aa785f4c">More...</a><br /></td></tr>
<tr class="separator:aa0ade441f6b17040ee8d25b8aa785f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09e83972400dc2b4a0159005b7bbf121"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#a09e83972400dc2b4a0159005b7bbf121">~Drain_base</a> ()</td></tr>
<tr class="memdesc:a09e83972400dc2b4a0159005b7bbf121"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes depth_sub and rgb_sub.  <a href="#a09e83972400dc2b4a0159005b7bbf121">More...</a><br /></td></tr>
<tr class="separator:a09e83972400dc2b4a0159005b7bbf121"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a19a318be0cd6ee62183abcd03d61fdaf"><td class="memItemLeft" align="right" valign="top">virtual ros::NodeHandle &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#a19a318be0cd6ee62183abcd03d61fdaf">getMyNodeHandle</a> ()=0</td></tr>
<tr class="memdesc:a19a318be0cd6ee62183abcd03d61fdaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual function to fetch node handle.  <a href="#a19a318be0cd6ee62183abcd03d61fdaf">More...</a><br /></td></tr>
<tr class="separator:a19a318be0cd6ee62183abcd03d61fdaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92b340ce02bdcd5b0a5e9aa8327671a7"><td class="memItemLeft" align="right" valign="top">virtual ros::NodeHandle &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#a92b340ce02bdcd5b0a5e9aa8327671a7">getMyPrivateNodeHandle</a> ()=0</td></tr>
<tr class="memdesc:a92b340ce02bdcd5b0a5e9aa8327671a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pure virtual function to fetch private node handle.  <a href="#a92b340ce02bdcd5b0a5e9aa8327671a7">More...</a><br /></td></tr>
<tr class="separator:a92b340ce02bdcd5b0a5e9aa8327671a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed530da601b063f99ba810b962960652"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#aed530da601b063f99ba810b962960652">initialize</a> ()</td></tr>
<tr class="memdesc:aed530da601b063f99ba810b962960652"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize and start the drain node.  <a href="#aed530da601b063f99ba810b962960652">More...</a><br /></td></tr>
<tr class="separator:aed530da601b063f99ba810b962960652"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ade118bf9029c601f33d5b4f6cb36d2d5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcamera_1_1Drain__base.html">Drain_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#ade118bf9029c601f33d5b4f6cb36d2d5">create_directories</a> ()</td></tr>
<tr class="memdesc:ade118bf9029c601f33d5b4f6cb36d2d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new directory under base path.  <a href="#ade118bf9029c601f33d5b4f6cb36d2d5">More...</a><br /></td></tr>
<tr class="separator:ade118bf9029c601f33d5b4f6cb36d2d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cccc259a1bb885a71b091e64a21b85d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcamera_1_1Drain__base.html">Drain_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#a2cccc259a1bb885a71b091e64a21b85d">define_subscribers</a> ()</td></tr>
<tr class="memdesc:a2cccc259a1bb885a71b091e64a21b85d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define as many subscribers as required by diversity.  <a href="#a2cccc259a1bb885a71b091e64a21b85d">More...</a><br /></td></tr>
<tr class="separator:a2cccc259a1bb885a71b091e64a21b85d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d66ca824dc39947787ba56100b0218"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#ac0d66ca824dc39947787ba56100b0218">drain_depth_callback</a> (const sensor_msgs::Image::ConstPtr &amp;msg, int channel_num)</td></tr>
<tr class="memdesc:ac0d66ca824dc39947787ba56100b0218"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function to process depth channel images.  <a href="#ac0d66ca824dc39947787ba56100b0218">More...</a><br /></td></tr>
<tr class="separator:ac0d66ca824dc39947787ba56100b0218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f538cd55cff2cde3893a0558c533a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#ad0f538cd55cff2cde3893a0558c533a3">drain_rgb_callback</a> (const sensor_msgs::Image::ConstPtr &amp;msg, int channel_num)</td></tr>
<tr class="memdesc:ad0f538cd55cff2cde3893a0558c533a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function to process RGB channel images.  <a href="#ad0f538cd55cff2cde3893a0558c533a3">More...</a><br /></td></tr>
<tr class="separator:ad0f538cd55cff2cde3893a0558c533a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f0f6527eb40b409db571ecac95032ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcamera_1_1Drain__base.html">Drain_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#a2f0f6527eb40b409db571ecac95032ca">save_image</a> (cv_bridge::CvImageConstPtr cv_ptr, std_msgs::Header header, unsigned int channel)</td></tr>
<tr class="memdesc:a2f0f6527eb40b409db571ecac95032ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save image to directory. Depth images (encoded in 16-bit unsigned) are saved in PNG format. RGB images (encoded in BGR8 order) are saved in JPG format.  <a href="#a2f0f6527eb40b409db571ecac95032ca">More...</a><br /></td></tr>
<tr class="separator:a2f0f6527eb40b409db571ecac95032ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac84c8172e28f92cb0ffb6af416d53740"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#ac84c8172e28f92cb0ffb6af416d53740">timerCallback</a> (const ros::TimerEvent &amp;event)</td></tr>
<tr class="memdesc:ac84c8172e28f92cb0ffb6af416d53740"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the transmission loss estimate. Being called by the timer everytime the timer has expired.  <a href="#ac84c8172e28f92cb0ffb6af416d53740">More...</a><br /></td></tr>
<tr class="separator:ac84c8172e28f92cb0ffb6af416d53740"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ad329ed9ea4f962c123981e83f3589404"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#ad329ed9ea4f962c123981e83f3589404">base_path</a> = <a class="el" href="namespacecamera.html#abc050132acadbceeeab9242610a76f25">camera::Default_path</a></td></tr>
<tr class="memdesc:ad329ed9ea4f962c123981e83f3589404"><td class="mdescLeft">&#160;</td><td class="mdescRight">The path where the folder will be created.  <a href="#ad329ed9ea4f962c123981e83f3589404">More...</a><br /></td></tr>
<tr class="separator:ad329ed9ea4f962c123981e83f3589404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a906ffb8d2289a7f5126b95c371787839"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classhelper_1_1Counter.html">helper::Counter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#a906ffb8d2289a7f5126b95c371787839">depth_counter</a></td></tr>
<tr class="memdesc:a906ffb8d2289a7f5126b95c371787839"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count the number of received depth frames and estimate lost of frames during transmission.  <a href="#a906ffb8d2289a7f5126b95c371787839">More...</a><br /></td></tr>
<tr class="separator:a906ffb8d2289a7f5126b95c371787839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab69e2c159c745fa0f964bc7725bd1be7"><td class="memItemLeft" align="right" valign="top">ros::Subscriber *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#ab69e2c159c745fa0f964bc7725bd1be7">depth_sub</a></td></tr>
<tr class="memdesc:ab69e2c159c745fa0f964bc7725bd1be7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dynamic array of depth channel subscribers.  <a href="#ab69e2c159c745fa0f964bc7725bd1be7">More...</a><br /></td></tr>
<tr class="separator:ab69e2c159c745fa0f964bc7725bd1be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a699c00f8a115b570d55e3dc665398b7f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#a699c00f8a115b570d55e3dc665398b7f">diversity</a> = <a class="el" href="namespacecamera.html#acb72316f1bff6bbfdc420a328329b907">camera::Default_drain_diversity</a></td></tr>
<tr class="memdesc:a699c00f8a115b570d55e3dc665398b7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drain diversity.  <a href="#a699c00f8a115b570d55e3dc665398b7f">More...</a><br /></td></tr>
<tr class="separator:a699c00f8a115b570d55e3dc665398b7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2f8716dcaf5d71884871f767b20c079"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#ad2f8716dcaf5d71884871f767b20c079">folder_path</a></td></tr>
<tr class="memdesc:ad2f8716dcaf5d71884871f767b20c079"><td class="mdescLeft">&#160;</td><td class="mdescRight">Path of the created directory (the directory that contains the sub-directories rgb_images and depth_images)  <a href="#ad2f8716dcaf5d71884871f767b20c079">More...</a><br /></td></tr>
<tr class="separator:ad2f8716dcaf5d71884871f767b20c079"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e5ce3c148bb5c08b846c6b93cf8c07f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classhelper_1_1Counter.html">helper::Counter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#a4e5ce3c148bb5c08b846c6b93cf8c07f">rgb_counter</a></td></tr>
<tr class="memdesc:a4e5ce3c148bb5c08b846c6b93cf8c07f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count the number of received RGB frames and estimate lost of frames during transmission.  <a href="#a4e5ce3c148bb5c08b846c6b93cf8c07f">More...</a><br /></td></tr>
<tr class="separator:a4e5ce3c148bb5c08b846c6b93cf8c07f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61832d08c8b79d56179fdd304af36c55"><td class="memItemLeft" align="right" valign="top">ros::Subscriber *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#a61832d08c8b79d56179fdd304af36c55">rgb_sub</a></td></tr>
<tr class="memdesc:a61832d08c8b79d56179fdd304af36c55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dynamic array of RGB channel subscribers.  <a href="#a61832d08c8b79d56179fdd304af36c55">More...</a><br /></td></tr>
<tr class="separator:a61832d08c8b79d56179fdd304af36c55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae01a8f404cde27edf2844c562805261"><td class="memItemLeft" align="right" valign="top">ros::Timer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcamera_1_1Drain__base.html#aae01a8f404cde27edf2844c562805261">timer</a></td></tr>
<tr class="memdesc:aae01a8f404cde27edf2844c562805261"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manages the periodic display of receiver information.  <a href="#aae01a8f404cde27edf2844c562805261">More...</a><br /></td></tr>
<tr class="separator:aae01a8f404cde27edf2844c562805261"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interfaces with the file system. Converts sensor_msgs::Image into .jpg and .png format and stores them as images. </p>
<h2>Configurable parameters</h2>
<ol type="1">
<li><b>diversity</b>: number of topics that drain subscribes to</li>
<li><b>base_path</b>: path to create folder</li>
</ol>
<h2>Usage</h2>
<p>Source_drain is an abstract class that provides nearly all functionality needed by a source node which interfaces with the camera. Its two pure virtual functions, getMyNodeHandle and getMyPrivateNodeHandle need to be implemented by derived classes. </p>

<p>Definition at line <a class="el" href="my__nodes_8h_source.html#l00433">433</a> of file <a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa0ade441f6b17040ee8d25b8aa785f4c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">camera::Drain_base::Drain_base </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes depth_sub and rgb_sub as nullptr. </p>

<p>Definition at line <a class="el" href="my__nodes_8h_source.html#l00438">438</a> of file <a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>.</p>

</div>
</div>
<a class="anchor" id="a09e83972400dc2b4a0159005b7bbf121"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">camera::Drain_base::~Drain_base </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deletes depth_sub and rgb_sub. </p>

<p>Definition at line <a class="el" href="drain__base_8cpp_source.html#l00016">16</a> of file <a class="el" href="drain__base_8cpp_source.html">drain_base.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ade118bf9029c601f33d5b4f6cb36d2d5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcamera_1_1Drain__base.html">Drain_base</a> &amp; camera::Drain_base::create_directories </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a new directory under base path. </p>
<p>The new directory is named with the format "year_month_date_hour_minute" based on the host's local time setting. E.g. "2020_5_22_15_4" means the directory was created at 15:04, May 22nd, 2020</p>
<p>Under this newly created director, two sub-directories - "rgb_images" and "depth_images" - are also created.</p>
<p>After creating directories, the current path is set to be <a class="el" href="classcamera_1_1Drain__base.html#ad2f8716dcaf5d71884871f767b20c079">folder_path</a>. </p><dl class="section return"><dt>Returns</dt><dd>Reference to self, allowing method chaining. </dd></dl>

<p>Definition at line <a class="el" href="drain__base_8cpp_source.html#l00033">33</a> of file <a class="el" href="drain__base_8cpp_source.html">drain_base.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2cccc259a1bb885a71b091e64a21b85d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcamera_1_1Drain__base.html">Drain_base</a> &amp; camera::Drain_base::define_subscribers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Define as many subscribers as required by diversity. </p>
<p>The following topics will be subscribed to by the drain:</p>
<p>camultiplex/depthx, where x=0, 1, ..., diversity-1</p>
<p>camultiplex/RGBx, where x=0, 1, ..., diversity-1</p>
<dl class="section return"><dt>Returns</dt><dd>Reference to self, allowing method chaining. </dd></dl>

<p>Definition at line <a class="el" href="drain__base_8cpp_source.html#l00069">69</a> of file <a class="el" href="drain__base_8cpp_source.html">drain_base.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac0d66ca824dc39947787ba56100b0218"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void camera::Drain_base::drain_depth_callback </td>
          <td>(</td>
          <td class="paramtype">const sensor_msgs::Image::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>channel_num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function to process depth channel images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>A shared_ptr to the received message. </td></tr>
    <tr><td class="paramname">channel_num</td><td>Index of the topic being subscribed to. Currently unused. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classcamera_1_1Drain__base.html#ad0f538cd55cff2cde3893a0558c533a3" title="Callback function to process RGB channel images. ">drain_rgb_callback</a> </dd></dl>

<p>Definition at line <a class="el" href="drain__base_8cpp_source.html#l00113">113</a> of file <a class="el" href="drain__base_8cpp_source.html">drain_base.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad0f538cd55cff2cde3893a0558c533a3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void camera::Drain_base::drain_rgb_callback </td>
          <td>(</td>
          <td class="paramtype">const sensor_msgs::Image::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>channel_num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function to process RGB channel images. </p>
<p>Callback function uses cv_bridge::toCvShare to convert the received sensor_msgs::Image into a read-only reference to an instance of OpenCV Mat</p>
<p>Another choice is to call cv_bridge::toCvCopy instead of toCvShare; this allows the callback function to do mutations on the CV image.</p>
<p>The second parameter of cv_bridge::toCvShare - encoding - infers the desired encoding of the image data. If left empty, the returned CvImage has the same encoding as the input image.</p>
<p>In the case of our RGB channel image, it arrives from the source encoded in RGB8 format (24 bits); however when storing the image with cv::imwrite, only BGR8 format is allowed. Therefore "bgr8" is passed in.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>A shared_ptr to the received message. </td></tr>
    <tr><td class="paramname">channel_num</td><td>Index of the topic being subscribed to. Currently unused. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Turotial for ROS package cv_bridge on how to convert between ROS images and CV images: <a href="http://wiki.ros.org/cv_bridge/Tutorials/UsingCvBridgeToConvertBetweenROSImagesAndOpenCVImages">http://wiki.ros.org/cv_bridge/Tutorials/UsingCvBridgeToConvertBetweenROSImagesAndOpenCVImages</a> </dd>
<dd>
ROS publisher and subscribers <a href="http://wiki.ros.org/roscpp/Overview/Publishers%20and%20Subscribers">http://wiki.ros.org/roscpp/Overview/Publishers%20and%20Subscribers</a> </dd></dl>

<p>Definition at line <a class="el" href="drain__base_8cpp_source.html#l00132">132</a> of file <a class="el" href="drain__base_8cpp_source.html">drain_base.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a19a318be0cd6ee62183abcd03d61fdaf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual ros::NodeHandle&amp; camera::Drain_base::getMyNodeHandle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual function to fetch node handle. </p>
<dl class="section return"><dt>Returns</dt><dd>(Public) node handle </dd></dl>

<p>Implemented in <a class="el" href="classcamera_1_1Drain__independent.html#a6f9814dbbdc3e0dcabb27dece89ab01a">camera::Drain_independent</a>, and <a class="el" href="classcamera_1_1Drain__nodelet.html#ac05e859840c03bd67693a291a2b02ef9">camera::Drain_nodelet</a>.</p>

</div>
</div>
<a class="anchor" id="a92b340ce02bdcd5b0a5e9aa8327671a7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual ros::NodeHandle&amp; camera::Drain_base::getMyPrivateNodeHandle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pure virtual function to fetch private node handle. </p>
<dl class="section return"><dt>Returns</dt><dd>Private node handle </dd></dl>

<p>Implemented in <a class="el" href="classcamera_1_1Drain__independent.html#a07453da8e6d2887af09a1d1ff8353b04">camera::Drain_independent</a>, and <a class="el" href="classcamera_1_1Drain__nodelet.html#ac23a1565318fc613dca9c7494540d39b">camera::Drain_nodelet</a>.</p>

</div>
</div>
<a class="anchor" id="aed530da601b063f99ba810b962960652"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void camera::Drain_base::initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize and start the drain node. </p>
<p>The method obtains parameters (diversity, base_path) from ROS parameter server and does the following in order:</p><ol type="1">
<li>Create a new directory under the path specified by base_path. The directory is named in the format of [yyyy_m_d_h_m]</li>
<li>Define as many subscribers as required by diversity. Unless you want to make the drain miss any frame transmitted by the source, drain diversity should be no less than source diversity. </li>
</ol>

<p>Definition at line <a class="el" href="drain__base_8cpp_source.html#l00023">23</a> of file <a class="el" href="drain__base_8cpp_source.html">drain_base.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2f0f6527eb40b409db571ecac95032ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcamera_1_1Drain__base.html">Drain_base</a> &amp; camera::Drain_base::save_image </td>
          <td>(</td>
          <td class="paramtype">cv_bridge::CvImageConstPtr&#160;</td>
          <td class="paramname"><em>cv_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std_msgs::Header&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>channel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save image to directory. Depth images (encoded in 16-bit unsigned) are saved in PNG format. RGB images (encoded in BGR8 order) are saved in JPG format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cv_ptr</td><td>CVImageConstPtr as generated in rgb_ or depth_callback. </td></tr>
    <tr><td class="paramname">header</td><td>Header of the image message. </td></tr>
    <tr><td class="paramname">channel</td><td>Specifies whether the image is depth or RGB. Valid values are RGB or DEPTH. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to self, allowing method chaining. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>OpenCV cv::imwrite: <a href="https://docs.opencv.org/3.4/d4/da8/group__imgcodecs.html">https://docs.opencv.org/3.4/d4/da8/group__imgcodecs.html</a> </dd></dl>

<p>Definition at line <a class="el" href="drain__base_8cpp_source.html#l00149">149</a> of file <a class="el" href="drain__base_8cpp_source.html">drain_base.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac84c8172e28f92cb0ffb6af416d53740"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void camera::Drain_base::timerCallback </td>
          <td>(</td>
          <td class="paramtype">const ros::TimerEvent &amp;&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prints the transmission loss estimate. Being called by the timer everytime the timer has expired. </p>
<p>Displays the following information when called: </p><div class="fragment"><div class="line">Drain: Depth received xxx frames, total transmission loss estimate is xxx frames</div><div class="line">Drain: <a class="code" href="my__nodes_8h.html#af66629d6b00cab37ec92e3933efa4bcc">RGB</a> received xxx frames, total transmission loss estimate is xxx frames</div></div><!-- fragment --> <dl class="section see"><dt>See also</dt><dd><a class="el" href="classcamera_1_1Drain__base.html#aae01a8f404cde27edf2844c562805261">timer</a> </dd></dl>

<p>Definition at line <a class="el" href="drain__base_8cpp_source.html#l00101">101</a> of file <a class="el" href="drain__base_8cpp_source.html">drain_base.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ad329ed9ea4f962c123981e83f3589404"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string camera::Drain_base::base_path = <a class="el" href="namespacecamera.html#abc050132acadbceeeab9242610a76f25">camera::Default_path</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The path where the folder will be created. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classcamera_1_1Drain__base.html#ade118bf9029c601f33d5b4f6cb36d2d5" title="Create a new directory under base path. ">create_directories</a> </dd></dl>

<p>Definition at line <a class="el" href="my__nodes_8h_source.html#l00533">533</a> of file <a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>.</p>

</div>
</div>
<a class="anchor" id="a906ffb8d2289a7f5126b95c371787839"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classhelper_1_1Counter.html">helper::Counter</a> camera::Drain_base::depth_counter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Count the number of received depth frames and estimate lost of frames during transmission. </p>
<p>Call <a class="el" href="classhelper_1_1Counter.html#afc12d9590eb63f4edcb223ba7aef2fd9" title="updateSeq ">helper::Counter::updateSeq</a> upon the serial number of every received frame in drain_rgb_callback or drain_depth_callback.</p>
<p>Example: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> callback(<span class="keyword">const</span> sensor_msgs::Image::ConstPtr&amp; msg){</div><div class="line">     <span class="comment">//process images</span></div><div class="line">     <span class="comment">//...</span></div><div class="line"></div><div class="line">     <span class="comment">//update counter with serial number</span></div><div class="line">     <a class="code" href="classcamera_1_1Drain__base.html#a906ffb8d2289a7f5126b95c371787839">depth_counter</a>.<a class="code" href="classhelper_1_1Counter.html#afc12d9590eb63f4edcb223ba7aef2fd9">updateSeq</a>(std::stoul(msg-&gt;header.frame_id));</div><div class="line">}</div></div><!-- fragment --><p><a class="el" href="classhelper_1_1Counter.html" title="Keeps track of the index of the images being received by the drain. ">helper::Counter</a> has an in-built mutex to ensure thread safety. No need for the caller to do additional protection. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="classhelper_1_1Counter.html" title="Keeps track of the index of the images being received by the drain. ">helper::Counter</a> </dd></dl>

<p>Definition at line <a class="el" href="my__nodes_8h_source.html#l00518">518</a> of file <a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab69e2c159c745fa0f964bc7725bd1be7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Subscriber* camera::Drain_base::depth_sub</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dynamic array of depth channel subscribers. </p>

<p>Definition at line <a class="el" href="my__nodes_8h_source.html#l00478">478</a> of file <a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>.</p>

</div>
</div>
<a class="anchor" id="a699c00f8a115b570d55e3dc665398b7f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int camera::Drain_base::diversity = <a class="el" href="namespacecamera.html#acb72316f1bff6bbfdc420a328329b907">camera::Default_drain_diversity</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Drain diversity. </p>
<p>Default value: <a class="el" href="namespacecamera.html#acb72316f1bff6bbfdc420a328329b907">camera::Default_drain_diversity</a> </p>

<p>Definition at line <a class="el" href="my__nodes_8h_source.html#l00548">548</a> of file <a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad2f8716dcaf5d71884871f767b20c079"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string camera::Drain_base::folder_path</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Path of the created directory (the directory that contains the sub-directories rgb_images and depth_images) </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classcamera_1_1Drain__base.html#ade118bf9029c601f33d5b4f6cb36d2d5" title="Create a new directory under base path. ">create_directories</a> </dd></dl>

<p>Definition at line <a class="el" href="my__nodes_8h_source.html#l00540">540</a> of file <a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4e5ce3c148bb5c08b846c6b93cf8c07f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classhelper_1_1Counter.html">helper::Counter</a> camera::Drain_base::rgb_counter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Count the number of received RGB frames and estimate lost of frames during transmission. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classcamera_1_1Drain__base.html#a906ffb8d2289a7f5126b95c371787839" title="Count the number of received depth frames and estimate lost of frames during transmission. ">depth_counter</a> </dd></dl>

<p>Definition at line <a class="el" href="my__nodes_8h_source.html#l00526">526</a> of file <a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>.</p>

</div>
</div>
<a class="anchor" id="a61832d08c8b79d56179fdd304af36c55"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Subscriber* camera::Drain_base::rgb_sub</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dynamic array of RGB channel subscribers. </p>

<p>Definition at line <a class="el" href="my__nodes_8h_source.html#l00484">484</a> of file <a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>.</p>

</div>
</div>
<a class="anchor" id="aae01a8f404cde27edf2844c562805261"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Timer camera::Drain_base::timer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Manages the periodic display of receiver information. </p>
<p>timerCallback is set to be called every 5 seconds to display information about the number of received frames.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classcamera_1_1Drain__base.html#ac84c8172e28f92cb0ffb6af416d53740" title="Prints the transmission loss estimate. Being called by the timer everytime the timer has expired...">timerCallback</a> </dd></dl>

<p>Definition at line <a class="el" href="my__nodes_8h_source.html#l00494">494</a> of file <a class="el" href="my__nodes_8h_source.html">my_nodes.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="my__nodes_8h_source.html">my_nodes.h</a></li>
<li><a class="el" href="drain__base_8cpp_source.html">drain_base.cpp</a></li>
</ul>
</div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/camultiplex">camultiplex</a><br />
Author(s): Fangjia Shen <shen449@purdue.edu></br />
<small>autogenerated on Thu May 28 2020 11:06:52</small>
</div>
</body>
</html>
